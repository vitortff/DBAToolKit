--BEFORE

SELECT MAX(SCRTBLTMSTIPOMENSAGEM.TMSCODMSG),MAX(SCRTBLMSGMENSAGEM.MSGNUMLN),MAX(SCRTBLMSGMENSAGEM.MSGDESMSG)
FROM SCRTBLHMSHISTMENSAGEM,SCRTBLMSGMENSAGEM,SCRTBLTMSTIPOMENSAGEM WHERE SCRTBLMSGMENSAGEM.TMSCODMSG = SCRTBLTMSTIPOMENSAGEM.TMSCODMSG AND SCRTBLHMSHISTMENSAGEM.TMSCODMSG = SCRTBLMSGMENSAGEM.TMSCODMSG AND SCRTBLHMSHISTMENSAGEM.HMSDATDTINICVIG = SCRTBLMSGMENSAGEM.HMSDATDTINICVIG AND SCRTBLTMSTIPOMENSAGEM.TMSCODMSG = ( SELECT scrtbltmstipomensagem.tmscodmsg FROM SCRTBLTMSTIPOMENSAGEM WHERE SCRTBLTMSTIPOMENSAGEM.TMSDESTPMSG =  '0100034886'  ) AND SCRTBLMSGMENSAGEM.MSGNUMLN = 1 AND SCRTBLHMSHISTMENSAGEM.HMSDATDTFIMVIG IS NULL

--AFTER

SELECT MAX(SCRTBLTMSTIPOMENSAGEM.TMSCODMSG),MAX(SCRTBLMSGMENSAGEM.MSGNUMLN),MAX(SCRTBLMSGMENSAGEM.MSGDESMSG)

FROM SCRTBLHMSHISTMENSAGEM,SCRTBLMSGMENSAGEM,SCRTBLTMSTIPOMENSAGEM WHERE SCRTBLMSGMENSAGEM.TMSCODMSG = SCRTBLTMSTIPOMENSAGEM.TMSCODMSG AND SCRTBLHMSHISTMENSAGEM.TMSCODMSG = SCRTBLMSGMENSAGEM.TMSCODMSG AND SCRTBLHMSHISTMENSAGEM.HMSDATDTINICVIG = SCRTBLMSGMENSAGEM.HMSDATDTINICVIG AND SCRTBLTMSTIPOMENSAGEM.TMSCODMSG=scrtbltmstipomensagem.tmscodmsg AND SCRTBLTMSTIPOMENSAGEM.TMSDESTPMSG =  '0100034886' AND SCRTBLMSGMENSAGEM.MSGNUMLN = 1 AND SCRTBLHMSHISTMENSAGEM.HMSDATDTFIMVIG IS NULL
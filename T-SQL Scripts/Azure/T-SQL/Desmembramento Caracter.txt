
--Primeiro Bloco
SELECT SUBSTRING('78,6,12,13;11,4,5,6,7,8;99,9,8,7,6,5,4;98,7,8,9,8,7,8,9,8,7,8,9,8,7,8,9',1,CHARINDEX(';', '78,6,12,13;11,4,5,6,7,8;99,9,8,7,6,5,4;98,7,8,9,8,7,8,9,8,7,8,9,8,7,8,9')-1) AS Bloco_1

--Segundo Bloco
SELECT SUBSTRING('78,6,12,13;11,4,5,6,7,8;99,9,8,7,6,5,4;98,7,8,9,8,7,8,9,8,7,8,9,8,7,8,9',CHARINDEX(';', '78,6,12,13;11,4,5,6,7,8;99,9,8,7,6,5,4;98,7,8,9,8,7,8,9,8,7,8,9,8,7,8,9')+1,CHARINDEX(';', '78,6,12,13;11,4,5,6,7,8;99,9,8,7,6,5,4;98,7,8,9,8,7,8,9,8,7,8,9,8,7,8,9')+1) AS Bloco_2

--Terceiro Bloco

DECLARE @LenghtB1 INT =  (SELECT LEN(SUBSTRING('78,6,12,13;11,4,5,6,7,8;99,9,8,7,6,5,4;98,7,8,9,8,7,8,9,8,7,8,9,8,7,8,9',1,CHARINDEX(';', '78,6,12,13;11,4,5,6,7,8;99,9,8,7,6,5,4;98,7,8,9,8,7,8,9,8,7,8,9,8,7,8,9')-1))+1)
DECLARE @LenghtB2 INT =  (SELECT LEN(SUBSTRING('78,6,12,13;11,4,5,6,7,8;99,9,8,7,6,5,4;98,7,8,9,8,7,8,9,8,7,8,9,8,7,8,9',CHARINDEX(';', '78,6,12,13;11,4,5,6,7,8;99,9,8,7,6,5,4;98,7,8,9,8,7,8,9,8,7,8,9,8,7,8,9')+1,CHARINDEX(';', '78,6,12,13;11,4,5,6,7,8;99,9,8,7,6,5,4;98,7,8,9,8,7,8,9,8,7,8,9,8,7,8,9')+1))+1)

DECLARE @LenghtB3 INT = @LenghtB1 + @LenghtB2
DECLARE @LenghtB3_Restante varchar(4000) = (SELECT SUBSTRING('78,6,12,13;11,4,5,6,7,8;99,9,8,7,6,5,4;98,7,8,9,8,7,8,9,8,7,8,9,8,7,8,9', @LenghtB3 +1 , 1000))

SELECT SUBSTRING('78,6,12,13;11,4,5,6,7,8;99,9,8,7,6,5,4;98,7,8,9,8,7,8,9,8,7,8,9,8,7,8,9', @LenghtB3 +1 , CHARINDEX(';', @LenghtB3_Restante)-1) as Bloco_3

